<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
    />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Carrier |</title>
 
    <include src="./partials/mainhead.html"> </include>
    <script src="./assets/js/main.js"></script>
  </head>
  <body
    x-data="{ page: 'carrier', 'loaded': true, 'darkMode': false, 'stickyMenu': false, 'sidebarToggle': false, 'scrollTop': false }"
    x-init="
         darkMode = JSON.parse(localStorage.getItem('darkMode'));
         $watch('darkMode', value => localStorage.setItem('darkMode', JSON.stringify(value)))"
    :class="{'dark bg-gray-900': darkMode === true}"
  >
    <!-- ===== Preloader Start ===== -->
    <include src="./partials/preloader.html"></include>
    <!-- ===== Preloader End ===== -->

    <!-- ===== Page Wrapper Start ===== -->
    <div class="flex h-screen overflow-hidden">
      <!-- ===== Sidebar Start ===== -->
      <include src="./partials/sidebar.html"></include>
      <!-- ===== Sidebar End ===== -->

      <!-- ===== Content Area Start ===== -->
      <div
        class="relative flex flex-1 flex-col overflow-y-auto overflow-x-hidden"
      >
        <!-- Small Device Overlay Start -->
        <include src="./partials/overlay.html" />
        <!-- Small Device Overlay End -->

        <!-- ===== Header Start ===== -->
        <include src="./partials/header.html" />
        <!-- ===== Header End ===== -->

        <!-- ===== Main Content Start ===== -->
        <main>
          <div class="mx-auto max-w-screen-2xl p-4 md:p-6">
            <!-- Breadcrumb Start -->
            <div x-data="{ pageName: `Carrier`}">
              <include src="./partials/breadcrumb.html" />
            </div>
            <!-- Breadcrumb End -->

            <div class="rounded-2xl border border-gray-200 bg-white mt-10 dark:border-gray-800 dark:bg-white/[0.03]">
              <div x-data="stepperForm()" class="w-full mx-auto px-4">
                <ol class="flex items-center justify-between w-full p-3 text-sm font-medium text-center text-gray-500 bg-white border border-gray-200 rounded-lg shadow-xs dark:text-gray-400 sm:text-base dark:bg-gray-800 dark:border-gray-700 sm:p-4 rtl:space-x-reverse">
                    <!-- Step 1 -->
                    <li class="flex-1 flex items-center justify-center"
                        :class="{ 'text-blue-600 dark:text-blue-500': step === 1, 'text-gray-500 dark:text-gray-400': step !== 1 }">
                        <span class="flex items-center justify-center w-6 h-6 text-xs font-bold border rounded-full"
                            :class="{ 'border-blue-600 bg-blue-600 text-white dark:border-blue-500': step === 1, 'border-gray-500 dark:border-gray-400': step !== 1 }">
                            1
                        </span>
                        <span class="ml-2 hidden sm:inline">Basic Info</span>
                    </li>
                    <!-- Step 2 -->
                    <li class="flex-1 flex items-center justify-center"
                        :class="{ 'text-blue-600 dark:text-blue-500': step === 2, 'text-gray-500 dark:text-gray-400': step !== 2 }">
                        <span class="flex items-center justify-center w-6 h-6 text-xs font-bold border rounded-full"
                            :class="{ 'border-blue-600 bg-blue-600 text-white dark:border-blue-500': step === 2, 'border-gray-500 dark:border-gray-400': step !== 2 }">
                            2
                        </span>
                        <span class="ml-2 hidden sm:inline">Other Details</span>
                    </li>
                
                    <!-- Step 3 -->
                    <li class="flex-1 flex items-center justify-center"
                        :class="{ 'text-blue-600 dark:text-blue-500': step === 3, 'text-gray-500 dark:text-gray-400': step !== 3 }">
                        <span class="flex items-center justify-center w-6 h-6 text-xs font-bold border rounded-full"
                            :class="{ 'border-blue-600 bg-blue-600 text-white dark:border-blue-500': step === 3, 'border-gray-500 dark:border-gray-400': step !== 3 }">
                            3
                        </span>
                        <span class="ml-2 hidden sm:inline">Backup Docs</span>
                    </li>
                
                    <!-- Step 3 -->
                    <!-- <li class="flex-1 flex items-center justify-center"
                        :class="{ 'text-blue-600 dark:text-blue-500': step === 3, 'text-gray-500 dark:text-gray-400': step !== 3 }">
                        <span class="flex items-center justify-center w-6 h-6 text-xs font-bold border rounded-full"
                            :class="{ 'border-blue-600 bg-blue-600 text-white dark:border-blue-500': step === 3, 'border-gray-500 dark:border-gray-400': step !== 3 }">
                            3
                        </span>
                        <span class="ml-2 hidden sm:inline">Backup Docs</span>
                    </li> -->
                </ol>
                
                
            
                <form class="mt-6 bg-white p-6 rounded-lg shadow dark:bg-gray-800 w-full border border-gray-200 dark:border-gray-700" @submit.prevent="saveAndSubmit" enctype="multipart/form-data" id="newCarrier">
                    <!-- Step 1: Basic Info -->
                    <div x-show="step === 1">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-3 mb-6">
                            <div>
                                <label class="block text-gray-700 dark:text-gray-300">Carrier Name <span class="text-red-700 text-2xl">*</span></label>
                                <input type="text" x-model="formData.name" name="name" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                            </div>
                            <style>
                                 #choosen-seleckt .chosen-container {
                                height: 40px !important;
                                background: none !important;
                                border: none !important;
                                vertical-align: middle !important;
                              }
                            </style>
                            </style>
                            <div class="choose-seleckt" style="z-index: 1 !important;">
                                <label class="block text-gray-700 dark:text-gray-300">State served</label>
                                <select x-model="formData.state_served" name="state_served[]" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white chosen-select" multiple>
                                    <!-- <option value="" selected disabled>Choose</option> -->
                                    <template x-for="(states, country) in allStates" :key="country">
                                        <optgroup :label="country">
                                            <template x-for="state in states" :key="state">
                                                <option x-text="state" :value="state"></option>
                                            </template>
                                        </optgroup>
                                    </template>
                                </select>

                            </div>
                            <div>
                                <label class="block text-gray-700 dark:text-gray-300">Carrier Code</label>
                                <input type="text" x-model="formData.code" name="code" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-3 gap-3 mb-6">
                            <div>
                                <label class="block text-gray-700 dark:text-gray-300">Offices</label>
                                <select x-model="formData.offices" name="offices" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                                    <option value="" selected disabled>Select </option>
                                    <option value="IN">IN</option>
                                </select>
                            </div>
                            <!-- <div>
                                <label class="block text-gray-700 dark:text-gray-300">Carrier #</label>
                                <input type="text" x-model="formData.carrier_number" name="carrier_number" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                            </div> -->
                            <div>
                                <label class="block text-gray-700 dark:text-gray-300">Carrier Type</label>
                                <select x-model="formData.type" name="type" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                                    <option value="" selected disabled>Select </option>
                                    <option value="third party">Third Party</option>
                                </select>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-4 gap-3 mb-6">
                            <div>
                                <label class="block text-gray-700 dark:text-gray-300">USDOT #</label>
                                <input type="text" x-model="formData.usdot_number" name="usdot_number" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                            </div>
                            <div>
                                <label class="block text-gray-700 dark:text-gray-300">MC #</label>
                                <input type="text" x-model="formData.mc_number" name="mc_number" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                            </div>
                            <div>
                                <label class="block text-gray-700 dark:text-gray-300">SCAC</label>
                                <input type="text" x-model="formData.scac" name="scac" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                            </div>
                            <div>
                                <label class="block text-gray-700 dark:text-gray-300">Tax ID / EIN</label>
                                <input type="text" x-model="formData.tax_id" name="tax_id" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-4 gap-3 mb-6">
                            <div>
                                <label class="block text-gray-700 dark:text-gray-300">Contact Name</label>
                                <input type="text" x-model="formData.contact_name" id="contact_name" name="contact_name" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                                </div>
                            <div>
                                <label class="block text-gray-700 dark:text-gray-300">Cell Phone</label>
                                <input type="text" x-model="formData.cell_phone" id="cell_phone" name="cell_phone" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                            </div>
                            <div>
                                <label class="block text-gray-700 dark:text-gray-300">Cell Carrier</label>
                                <select x-model="formData.cell_carrier" name="cell_carrier" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                                    <option value="" selected disabled>Select </option>
                                    <option value="verizon">Verizon</option>
                                    <option value="att">AT&T</option>
                                    <option value="tmobile">T-Mobile</option>
                                    <option value="sprint">Sprint</option>
                                    <option value="united">United</option>
                                    <option value="virgin">Virgin Mobile</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                            <!-- <div>
                                <label class="block text-gray-700 dark:text-gray-300">Carrier Access to Mobile app</label>
                                <select x-model="formData.carrier_access" name="carrier_access" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                                    <option value="" selected disabled>Select </option>
                                    <option value="activate_access">Activate Access</option>
                                    <option value="deactivate_access">Deactivate Access</option>
                                    <option value="resend_pin">Resend PIN</option>
                                </select>
                            </div> -->
                            <div>
                                <label class="block text-gray-700 dark:text-gray-300">Office Phone No</label>
                                <input type="text" x-model="formData.office_phone" id="office_phone" name="office_phone" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                            </div>
                        </div>
                    
<!-- 
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mb-6">
                            <div>
                            <label class="block text-gray-700 dark:text-gray-300">Contact Name</label>
                            <input type="text" x-model="formData.contact_name" id="contact_name" name="contact_name" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                            </div>
                            <div>
                                <label class="block text-gray-700 dark:text-gray-300">Mobile app settings</label>
                                <label for="show_payment_in_mobile_app">
                                <input type="checkbox" x-model="formData.show_payment_in_mobile_app" id="show_payment_in_mobile_app" name="show_payment_in_mobile_app" class="w-2 p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white"> <span class="text-gray-700 dark:text-gray-300">Show payment in mobile app</span> </label>
                            </div>
                        </div> -->

                        <div class="grid grid-cols-1 md:grid-cols-3 gap-3 mb-6">
                            <div>
                                <label class="block text-gray-700 dark:text-gray-300">Email <span class="text-red-700 text-2xl">*</span></label>
                                <input type="email" x-model="formData.email" id="email" name="email" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                            </div>
                            <div>
                                <label class="block text-gray-700 dark:text-gray-300">Address 1</label>
                                <input type="text" x-model="formData.primary_address" id="primary_address" name="primary_address" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                            </div>
                            <div>
                                <label class="block text-gray-700 dark:text-gray-300">Address 2</label>
                                <input type="text" x-model="formData.secondary_address" name="secondary_address" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                            </div>
                        </div>

                    <script>
                        $(function() {
                            $("#move_date_datepicker").datepicker({
                                
                            });
                        });
                    </script>

                    <div class="grid grid-cols-1 md:grid-cols-4 gap-3 mb-6">
                        <div>
                            <label class="block text-gray-700 dark:text-gray-300">City</label>
                            <input type="text" x-model="formData.city" id="city" name="city" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                        </div>
                        <div>
                            <label class="block text-gray-700 dark:text-gray-300">State / Province</label>
                            <input type="text" x-model="formData.state" id="state" name="state" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                        </div>
                        <div>
                            <label class="block text-gray-700 dark:text-gray-300">Zip / Postal Code</label>
                            <input type="text" x-model="formData.zip" name="zip" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                        </div>
                        
                        <div>
                            <label class="block text-gray-700 dark:text-gray-300">Country</label>
                            <input type="text" x-model="formData.country" name="country" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-3 mb-2">
                        <div>
                            <label class="block text-gray-700 dark:text-gray-300">Fax No</label>
                            <input type="text" x-model="formData.fax_no" id="" name="fax_no" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                        </div>
                        <div>
                            <label class="block text-gray-700 dark:text-gray-300">Toll Free No</label>
                            <input type="text" x-model="formData.toll_free_number" id="toll_free_number" name="toll_free_number" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                        </div>
                        <div>
                            <label class="block text-gray-700 dark:text-gray-300">Other Contact Info</label>
                            <textarea type="text" cols="1" rows="1" x-model="formData.other_contact_info" name="other_contact_info" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white"> </textarea>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-4 gap-3 mb-2">
                        <div>
                            <label class="block text-gray-700 dark:text-gray-300">No of Drivers</label>
                            <input type="number" x-model="formData.no_of_drivers" id="no_of_drivers" name="no_of_drivers" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                        </div>
                        <div>
                            <label class="block text-gray-700 dark:text-gray-300">Power Units (Truck)</label>
                            <input type="number" x-model="formData.power_units" id="power_units" name="power_units" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                        </div>
                        <div>
                            <label class="block text-gray-700 dark:text-gray-300 text-sm">Other equipment (chassis, reefers, vans etc)</label>
                            <input type="text" x-model="formData.other_equipments" id="other_equipments" name="other_equipments" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                        </div>
                        <div id="choose-select">
                            <label class="block text-gray-700 dark:text-gray-300">Carrier profile / options</label>
                            <select multiple x-model="formData.carrier_profile" name="carrier_profile[]" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white chosen-select" >
                                <option value="drayage">Drayage</option>
                                <option value="over_the_road">Over the road >500 Miles</option>
                                <option value="warehouse">Warehouse</option>
                                <option value="local_intrastate">Local/Intra state only</option>
                                <option value="harzmart">Harmat permit</option>
                                <option value="over_weight_permit">Over weight permit</option>
                                <option value="alcohol_permit">Alcohol permit</option>
                                <option value="resdential_delivery">Residential Delivery</option>
                                <option value="transload_service">Transload Service</option>
                            </select>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-4 gap-3 mb-2">
                        <div>
                            <label class="block text-gray-700 dark:text-gray-300 text-sm">( rating )Carrier belongs to these pay categories</label>
                            <select x-model="formData.rating" name="rating" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                                <option value="" selected disabled>Select </option>
                                <option value="1">None</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-gray-700 dark:text-gray-300">Note about the choices made</label>
                            <textarea cols="1" rows="1" type="text" x-model="formData.note_about_choices" id="" name="note_about_choices" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white"> </textarea>
                        </div>
                        <div id="choose-select">
                            <label class="block text-gray-700 dark:text-gray-300">Carries these cargo</label>
                            <select x-model="formData.carries_this_cargo" name="carries_this_cargo[]" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white chosen-select" multiple>
                                <!-- <option value="" selected disabled>Select </option> -->
                                <option value="general_fright">General Fright</option>
                                <option value="intermodial_containers">General Containers</option>
                                <option value="harzadous_commodities">Harzadous Commodities</option>
                                <option value="agricultural_farm_supplies">Agricultural Farm Supplies</option>
                                <option value="beverages">Beverages</option>
                                <option value="building_materials">Bulding Materials</option>
                                <option value="chemicals">Chemicals</option>

                            </select>
                        </div>
                        <div>
                            <label class="block text-gray-700 dark:text-gray-300">Start Date</label>
                            <input type="text" x-model="formData.start_date" id="carrier_start_date" name="start_date" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                        </div>
                    </div>
                    <script>
                        $(function() {
                            $('#carrier_start_date').datepicker({
                                //dateFormat: 'dd-mm-yy'
                            });
                        })
                    </script>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-3 mb-2">
                        <div>
                            <label class="block text-gray-700 dark:text-gray-300"> Flash note to dispatchers about this carrier</label>
                            <textarea cols="1" rows="1" type="text" x-model="formData.flash_note_to_riders_about_this_carrier" id="" name="flash_note_to_riders_about_this_carrier" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white"> </textarea>
                        </div>
                        <div>
                            <label class="block text-gray-700 dark:text-gray-300"> Flash note to payroll</label>
                            <textarea cols="1" rows="1" type="text" x-model="formData.flash_note_to_payroll_about_this_carrier" id="" name="flash_note_to_payroll_about_this_carrier" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white"> </textarea>
                        </div>
                        <div>
                            <label class="block text-gray-700 dark:text-gray-300"> Internal note</label>
                            <textarea cols="1" rows="1" type="text" x-model="formData.internal_note" id="" name="internal_note" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white"> </textarea>
                        </div>
                    </div>
                </div>

                <script>
                    function calculate() {
            $(".chargecalc").each(function() {
                let units = parseFloat($(this).find(".unit").val()) || 0;
                let rate = parseFloat($(this).find(".rate").val()) || 0;
                let discount = parseFloat($(this).find(".discount").val()) || 0;

                let total = units * rate;
                let netTotal = total - discount;

                $(this).find(".amount").val(total);
                $(this).find(".total").val(total);
                $(this).find(".net_total").val(netTotal);
            });
        }

        // Trigger calculation on input change
        $(document).on("input", ".calc-field", function() {
            calculate();
        });
                </script>

                    <!-- Step 2: Other Details -->
                    <div x-show="step === 2">
                        <div>
                            <!-- <h4 class="mt-4 mb-3 block text-gray-700 dark:text-gray-300">Freight broker info ( if different from bill-to party )</h4> -->
                            <div id="" class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                                <div>
                                    <label class="block text-gray-700 dark:text-gray-300">
                                        Insurance provider
                                    </label>
                                    <select type="text" x-model="formData.insurance_provider" name="insurance_provider" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white" placeholder=""> 
                                        <option value="" selected disabled> Select</option>
                                        <option value="NAIT">NAIT</option>
                                        <option value="progressive">Progressive</option>
                                        <option value="allstate">Allstate</option>
                                        <option value="nation_wide">Nation wide</option>
                                        <option value="hiscox_insuramce">Hiscox Insurance</option>
                                        <option value="farmers_isurance">Farmers Insurance</option>
                                        <option value="state_farm">State Farm</option>
                                        <option value="titan_insurance">Titan Insurance</option>
                                        <option value="other">Other</option>
                                        </select>
                                </div>
                                <script>
                                    $(document).ready(function() {
                                        $(".insurance_expire").datepicker({
                                        dateFormat: "yy-mm-dd",
                                        changeMonth: true,
                                        changeYear: true,
                                        yearRange: "1900:2100"
                                    });
                                    })
                                </script>
                                <div>
                                    <label class="block text-gray-700 dark:text-gray-300">Insurance Expires</label>
                                    <input type="text" x-model="formData.insurance_expire" name="insurance_expire" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white insurance_expire" placeholder="" id="insurance_expire">
                                </div>
                                </div>
                                <div>
                                    <div class="space-y-4">
                                        <template x-for="(insurance, index) in formData.insurances" :key="index">
                                          <div class="p-4 border rounded-lg dark:border-gray-600 relative">
                                            <!-- Remove button (shown for all insurance including first one) -->
                                            <button 
                                              x-show="formData.insurances.length > 1" 
                                              @click="removeInsurance(index)"
                                              class="absolute top-2 right-2 text-red-500 hover:text-red-700"
                                              type="button"
                                              title="Remove Insurance"
                                            >
                                              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                                <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd" />
                                              </svg>
                                            </button>
                                            
                                            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                              <div>
                                                <label class="block text-gray-700 dark:text-gray-300">Coverage</label>
                                                <select x-model="insurance.coverage" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                                                    <option value="" selected disabled> Choose</option>
                                                    <option value="general_liability">General Liability</option>
                                                    <option value="auto_liability">Auto Liability</option>
                                                    <option value="excess_liability">Excess Liability</option>
                                                    <option value="trailer_intercharge">Trailer Intercharge</option>
                                                    <option value="cargo_insurance">Cargo Insurance</option>
                                                    <option value="workers_compesation">Worker's Compesation</option>
                                                </select>
                                              </div>
                                              <div>
                                                <label class="block text-gray-700 dark:text-gray-300">Amount</label>
                                                <input type="text" x-model="insurance.amount" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white" placeholder="">
                                              </div>
                                              
                                              <div>
                                                <label class="block text-gray-700 dark:text-gray-300">Policy #</label>
                                                <input type="text" x-model="insurance.policy_number" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white" placeholder="">
                                              </div>
                                              <script>
                                                $(document).ready(function() {
                                                    $(".iexpires").datepicker({
                                                    dateFormat: "yy-mm-dd",
                                                    changeMonth: true,
                                                    changeYear: true,
                                                    yearRange: "1900:2100"
                                                    });
                                                })
                                              </script>
                                              <div>
                                                <label class="block text-gray-700 dark:text-gray-300">Expires</label>
                                                <input type="text" x-model="insurance.expires" id="iexpires" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white iexpires" placeholder="">
                                              </div>
                                            </div>
                                          </div>
                                        </template>
                                      </div>
                                  
                                      <!-- Add insurance Button (always visible) -->
                                      <button
                                        @click="addInsurance()"
                                        type="button"
                                        class="mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
                                      >
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                                          <path fill-rule="evenodd" d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z" clip-rule="evenodd" />
                                        </svg>
                                        Add Another Provider
                                      </button>
                                </div>



                                <div id="" class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                                    <!-- <h4 class="mt-4 mb-3 block text-gray-700 dark:text-gray-300">Insurance coverage detail</h4> -->
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300">Payment Terms</label>
                                        <select type="text" x-model="formData.payment_terms" name="payment_terms" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white numberOnly" placeholder="" id="payment_terms">
                                            <option value="" selected disabled> Choose</option>
                                            <option value="general_liability">General Liability</option>
                                            <option value="auto_liability">Auto Liability</option>
                                            <option value="excess_liability">Excess Liability</option>
                                            <option value="trailer_intercharge">Trailer Intercharge</option>
                                            <option value="cargo_insurance">Cargo Insurance</option>
                                            <option value="workers_compesation">Worker's Compesation</option>
                                            </select>

                                    </div>
                                <!-- Load Note Radio Buttons and Checkbox -->
                                    
                                <div>
                                    <label class="block text-gray-700 dark:text-gray-300">Paid via</label>
                                    <select type="text" x-model="formData.paid_via" name="paid_via" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white" placeholder=""> 
                                        <option value="" selected disabled> Select</option>
                                        <option value="check">Check</option>
                                        <option value="credit_card">Credit Card</option>
                                        <option value="ach">ACH</option>
                                        <option value="cash">Cash</option>
                                        <option value="via_factoring">Via Factoring</option>
                                        <option value="wex_fleet_one">Wex Fleet one</option>
                                        <option value="zelle">Zelle</option>
                                        <option value="direct_deposit">Direct Deposit</option>
                                        <option value="other">Other</option>
                                        </select>
                                </div>
                                
                                <div>
                                    <label class="block text-gray-700 dark:text-gray-300">Account #</label>
                                    <input type="text" x-model="formData.account_number" name="account_number" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white" placeholder="" id="account_number">
                                </div>
                                
                                <div>
                                    <label class="block text-gray-700 dark:text-gray-300">Routing #</label>
                                    <input x-model="formData.routing_number" name="routing_number" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white" id="routing_number" />
                                </div>
                            </div>
                            <div id="" class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                                <div>
                                    <label class="block text-gray-700 dark:text-gray-300">Note About the Coverage</label>
                                    <input type="text" x-model="formData.note_about_coverage" name="note_about_coverage" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white" placeholder="" id="note_about_coverage" />
                                </div>
                            </div>
                                <div id="" class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300">Send settlements to these emails  (only if different from the main email)</label>
                                        <input type="email" x-model="formData.settlement_email_address" name="settlement_email_address" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white" placeholder="" id="settlement_email_address" />
                                    </div>
                                </div>

                                <div id="" class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 text-sm">Payment mailing address (if different from the main address)</label>
                                        <textarea cols="1" rows="1" type="email" x-model="formData.payment_mailling_address" name="payment_mailling_address" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white" placeholder="" id="payment_mailling_address" > </textarea>
                                    </div>

                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300 text-sm"> Payment contact (if different from the main contact)</label>
                                        <textarea cols="1" rows="1" type="text" x-model="formData.payment_contact" name="payment_contact" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white" placeholder="" id="payment_contact"> </textarea>
                                    </div>

                                    <div>
                                        <label class="block text-gray-700 dark:text-gray-300">
                                            Payment related note</label>
                                        <textarea cols="1" rows="1" type="text" x-model="formData.payment_related_notes" name="payment_related_notes" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white" placeholder="" id="payment_related_notes" > </textarea>
                                    </div>
                                </div>

                                
                                <!-- <div>
                                    <label class="block text-gray-700 dark:text-gray-300">Seal #</label>
                                    <input type="text" x-model="formData.seal_number" name="seal_number" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white" placeholder="">
                                </div> -->
                            </div>
                        </div>

                      
                    
                    <!-- Step 3: Backup Docs -->
                    <div x-show="step === 3">
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-3 mb-2">
                            <div>
                                <label class="block text-gray-700 dark:text-gray-300">Attach files</label>
                                <input type="file" x-model="formData.file" multiple name="file[]" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                            </div>
                        </div>
                    </div>
                
                    <!-- Step 3: Review & Submit -->
                    <!-- <div x-show="step === 3">
                        <div>
                            <label class="block text-gray-700 dark:text-gray-300">Attach files</label>
                            <input type="file" x-model="formData.file_path" multiple name="file_path[]" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                        </div>
                    </div> -->
                
                    <!-- Navigation Buttons -->
                    <div class="flex flex-wrap gap-2 mt-16 mb-10">
                        <!-- Previous Button -->
                        <button
                            type="button"
                            class="px-4 py-2 bg-gray-300 text-gray-700 rounded dark:bg-gray-600 dark:text-white hover:bg-gray-300 hover:text-gray-700 dark:hover:bg-gray-600 dark:hover:text-white"
                            x-show="step > 1"
                            @click="prevStep">
                            Previous
                        </button>
                
                        <!-- Next Button -->
                        <button type="button" class="px-4 py-2 bg-blue-600 text-white rounded dark:bg-blue-500"
                            x-show="step < 3" @click="nextStep">
                            Next
                        </button>
                
                        <!-- Save & Continue Later -->
                        <button type="button" class="px-4 py-2 bg-yellow-500 text-white rounded dark:bg-yellow-400"
                            @click="saveProgress">
                            Save & Continue Later
                        </button>
                
                        <!-- Submit Button (Only shows on Step 3) -->
                        <button type="submit" class="px-4 py-2 bg-green-600 text-white rounded dark:bg-green-500"
                            x-show="step === 3">
                            Submit
                        </button>
                    </div>

                </form>
            </div>
            </div>

          </div>
        </main>
        <!-- ===== Main Content End ===== -->
      </div>
      <!-- ===== Content Area End ===== -->
    </div>
    <!-- ===== Page Wrapper End ===== -->

    <script>
            function stepperForm() {
            return {
                step: localStorage.getItem('carrier_step') ? parseInt(localStorage.getItem('carrier_step')) : 1,
                formData: JSON.parse(localStorage.getItem('formData')) || {
                    name: '',
                    state_served: [],
                    code: '',
                    offices: '',
                    type: '',
                    usdot_number: '',
                    mc_number: '',
                    scac: '',
                    tax_id: '',
                    cell_phone: '',
                    cell_carrier: '',
                    office_phone: '',
                    email: '',
                    primary_address: '',
                    secondary_address: '',
                    city: '',
                    state: '',
                    zip: '',
                    country: '',
                    fax_no: '',
                    toll_free_number: '',
                    other_contact_info: '',
                    no_of_drivers: '',
                    power_units: '',
                    other_equipments: '',
                    carrier_profile: [],
                    rating: '',
                    note_about_choices: '',
                    carries_this_cargo: [],
                    carrier_start_date: '',
                    flash_note_to_riders_about_this_carrier: '',
                    flash_note_to_payroll_about_this_carrier: '',
                    internal_note: '',

                    insurance_provider:'',
                    insurance_expire:'',
                    payment_terms:'',
                    paid_via:'',
                    account_number:'',
                    routing_number:'',
                    note_about_coverage:'',
                    settlement_email_address:'',
                    payment_mailling_address:'',
                    payment_contact:'',
                    payment_related_notes:'',

                    insurances: [{  // Initialize with one empty provider
                    coverage: '',
                    amount: '',
                    policy_number: '',
                    expires: ''
                    }],
                },
                addInsurance() {
                if (!this.formData.insurances) {
                    this.formData.insurances = [];
                }
                this.formData.insurances.push({
                    coverage: '',
                    amount: '',
                    policy_number: '',
                    expires: ''
                });
                //this.saveProgress();
                },

                removeInsurance(index) {
                if (this.formData.insurances && index > 0 && this.formData.insurances.length > 1) {
                    this.formData.insurances.splice(index, 1);
                    //this.saveProgress();
                }
                },

                selectedState: '',
                allStates: {
                    'United States': [
                        'Alabama', 'Alaska', 'Arizona', 'Arkansas', 'California', 'Colorado', 'Connecticut',
                        'Delaware', 'Florida', 'Georgia', 'Hawaii', 'Idaho', 'Illinois', 'Indiana', 'Iowa',
                        'Kansas', 'Kentucky', 'Louisiana', 'Maine', 'Maryland', 'Massachusetts', 'Michigan',
                        'Minnesota', 'Mississippi', 'Missouri', 'Montana', 'Nebraska', 'Nevada', 'New Hampshire',
                        'New Jersey', 'New Mexico', 'New York', 'North Carolina', 'North Dakota', 'Ohio',
                        'Oklahoma', 'Oregon', 'Pennsylvania', 'Rhode Island', 'South Carolina', 'South Dakota',
                        'Tennessee', 'Texas', 'Utah', 'Vermont', 'Virginia', 'Washington', 'West Virginia',
                        'Wisconsin', 'Wyoming'
                    ],
                    'Nigeria': [
                        'Abia', 'Adamawa', 'Akwa Ibom', 'Anambra', 'Bauchi', 'Bayelsa', 'Benue', 'Borno',
                        'Cross River', 'Delta', 'Ebonyi', 'Edo', 'Ekiti', 'Enugu', 'FCT - Abuja', 'Gombe',
                        'Imo', 'Jigawa', 'Kaduna', 'Kano', 'Katsina', 'Kebbi', 'Kogi', 'Kwara', 'Lagos',
                        'Nasarawa', 'Niger', 'Ogun', 'Ondo', 'Osun', 'Oyo', 'Plateau', 'Rivers', 'Sokoto',
                        'Taraba', 'Yobe', 'Zamfara'
                    ]
                },
                totalSteps: 3, // Adjust based on actual number of steps
                nextStep() {
                    if (this.step < this.totalSteps) {
                        this.step++;
                        this.saveProgress();
                    }
                },
                prevStep() {
                    if (this.step > 1) {
                        this.step--;
                        this.saveProgress();
                    }
                },
                saveProgress() {
                    localStorage.setItem('carrier_step', this.step);
                    localStorage.setItem('formData', JSON.stringify(this.formData));
                },
                saveAndSubmit() {
                    let form = document.getElementById("newCarrier");
                    let formData = new FormData(form);
                    if (this.formData && Array.isArray(this.formData.insurances)) {
                        this.formData.insurances.forEach((insurance, index) => {
                            if (insurance) {  // Additional check for each insurance object
                                formData.append(`insurances[${index}][coverage]`, insurance.coverage || '');
                                formData.append(`insurances[${index}][amount]`, insurance.amount || '');
                                formData.append(`insurances[${index}][policy_number]`, insurance.policy_number || '');
                                formData.append(`insurances[${index}][expires]`, insurance.expires || '');
                            }
                        });
                    }

                    // this.formData.insurances.forEach((insurance, index) => {
                    //     formData.append(`insurances[${index}][coverage]`, insurance.coverage);
                    //     formData.append(`insurances[${index}][amount]`, insurance.amount);
                    //     formData.append(`insurances[${index}][policy_number]`, insurance.policy_number);
                    //     formData.append(`insurances[${index}][expires]`, insurance.expires);
                    // });
                    // for (let pair of formData.entries()) {
                    //     console.log(pair[0] + ": " + pair[1]);
                    // }
                     console.log(localStorage.getItem('auth_token'))
                    // return
                    $.ajax({
                        url: requestURL+'/carriers/create',
                        type: 'POST',
                        data: formData,
                        processData: false,
                        contentType: false,
                        headers: {
                            'Authorization': 'Bearer ' + localStorage.getItem('auth_token'),
                            'Accept': 'application/json'
                        },

                        beforeSend:function(){
                            document.getElementById("Ajaxbackdrop").style.display = 'flex'
                        },

                        success: (response) => {
                            document.getElementById("Ajaxbackdrop").style.display = 'none'
                            //console.log('Form submitted successfully:', response);
                            createToast('success', response.message);
                            localStorage.removeItem('formData');
                            localStorage.removeItem('carrier_step');
                            //alert("Form submitted successfully!");
                        },
                         error: (xhr, status, error) => {
                            document.getElementById("Ajaxbackdrop").style.display = 'none'
                            console.error('Form submission failed:', xhr.responseText);

                        try {
                            let response = JSON.parse(xhr.responseText);
                            
                            if (response.errors) {
                                let messages = Object.values(response.errors).flat().join('<br>'); // Combines multiple errors
                                createToast('error', messages);
                            } else if (response.message) {
                                createToast('error', response.message);
                            } else {
                                createToast('error', 'An unexpected error occurred. Please try again.');
                            }
                        } catch (e) {
                            createToast('error', 'An error occurred. Please check your input and try again.');
                        }
                    }
                    });

                    // Clear stored data after submission
                    localStorage.removeItem('formData');
                    localStorage.removeItem('carrier_step');

                    // Reset form data
                    this.formData = {
                        name: '',
                        state_served: [],
                        code: '',
                        offices: '',
                        type: '',
                        usdot_number: '',
                        mc_number: '',
                        scac: '',
                        tax_id: '',
                        cell_phone: '',
                        cell_carrier: '',
                        office_phone: '',
                        email: '',
                        primary_address: '',
                        secondary_address: '',
                        city: '',
                        state: '',
                        zip: '',
                        country: '',
                        fax_no: '',
                        toll_free_number: '',
                        other_contact_info: '',
                        no_of_drivers: '',
                        power_units: '',
                        other_equipments: '',
                        carrier_profile: '',
                        rating: '',
                        note_about_choices: '',
                        carries_this_cargo: '',
                        carrier_start_date: '',
                        flash_note_to_riders_about_this_carrier: '',
                        flash_note_to_payroll_about_this_carrier: '',
                        internal_note: '',

                        insurance_provider:'',
                        insurance_expire:'',
                        payment_terms:'',
                        paid_via:'',
                        account_number:'',
                        routing_number:'',
                        note_about_coverage:'',
                        settlement_email_address:'',
                        payment_mailling_address:'',
                        payment_contact:'',
                        payment_related_notes:'',

                        insurances: [],

                    };
                    //this.step = 1;
                }
            }
        }



      function handleLoadTypeChange(value) {
    if (value === 'import') {
        console.log(`Load type changed to ${value}`);
        // You can add specific logic for import/export here
        // For example, show/hide specific form sections
        document.getElementById('container').style.display = '';
        // Example: Show a message or change UI elements
        //alert(`Selected load type: ${value}`);
        
        // You could show/hide specific form sections
        // document.getElementById('importSection').style.display = value === 'import' ? 'block' : 'none';
        // document.getElementById('exportSection').style.display = value === 'export' ? 'block' : 'none';
    }
    
    // Trigger auto-save when selection changes
    //handleInputChange();
}
      </script>
      <script>
        function duplicateContainer() {
            var container = document.getElementById("container");
            var containerList = document.getElementById("containerList");
    
            // Clone container and remove display:none
            var newContainer = container.cloneNode(true);
            newContainer.style.display = "block";
    
            // Append new container
            containerList.appendChild(newContainer);
        }

        function removeContainer(element) {
            element.parentElement.parentElement.remove();
        }

        function duplicateBillto()
        {
            var billto = document.getElementById("billto");
            var billtoList = document.getElementById("billtoList");
            var newBillto = billto.cloneNode(true);
            billtoList.appendChild(newBillto);
        }

        function removeBillto(element)
        {
            element.parentElement.parentElement.remove();
        }
        //

        function duplicatePickup()
        {
            var pickup = document.getElementById("pickUPP");
            var pickupList = document.getElementById("pickupList");
            var newPickup = pickup.cloneNode(true);
            pickupList.appendChild(newPickup);
        }
        function removePickup(element)
        {
            element.parentElement.parentElement.remove();
        }

        
        function duplicateDropAt()
        {
            var pickup = document.getElementById("dropAt");
            var pickupList = document.getElementById("dropAtList");
            var newPickup = pickup.cloneNode(true);
            pickupList.appendChild(newPickup);
        }
        function removeDropAt(element)
        {
            element.parentElement.parentElement.remove();
        }

        function duplicateCharges()
        {
            var pickup = document.getElementById("chargesDuplicate");
            var pickupList = document.getElementById("chargesList");
            var newPickup = pickup.cloneNode(true);
            pickupList.appendChild(newPickup);
        }
        function removeCharges(element)
        {
            element.parentElement.parentElement.remove();
        }

        function duplicateRecieve()
        {
            var pickup = document.getElementById("RecieveRepay");
            var pickupList = document.getElementById("RecieveRepayList");
            var newPickup = pickup.cloneNode(true);
            pickupList.appendChild(newPickup);
        }
        function removeRecieve(element)
        {
            element.parentElement.parentElement.remove();
        }

        $(document).ready(function() {
        $(".chosen-select").chosen({
            placeholder_text_multiple: "Select options",
            no_results_text: "Oops, nothing found!", 
            allow_single_deselect: true  
        });
});
// $(document).ready(function() {
//     $(".chosen-select").chosen();
// });
        
    </script>
      
  </body>
</html>
